<h1 class="title-lg">
  {{ mode === "edit" ? "تعديل طرف صناعي" : "إضافة طرف صناعي" }}
</h1>

<form class="padding-LR-24 column gap-16" [formGroup]="form" (ngSubmit)="submit()">
  <div class="width-100">
    <p class="title-md">بيانات الطرف</p>
    <span class="home-line"></span>
  </div>

  @if (mode === "edit") {
    <div class="row flex-center">
      <label class="label-lg">رقم الطرف</label>
      <input class="label-lg" type="text" [value]="part?.industrialPartId" disabled />
    </div>
  }

  <div class="row flex-center">
    <label class="label-lg">الاسم</label>
    <input class="label-lg" type="text" formControlName="name" placeholder="اسم الطرف الصناعي" />
  </div>

  <div class="row flex-center width-100">
    <label class="label-lg">الوصف</label>
    <textarea
      rows="2"
      class="label-lg"
      formControlName="description"
      placeholder="وصف اختياري"
    ></textarea>
  </div>

  <div class="width-100">
    <p class="title-md">الوحدات والأسعار</p>
    <span class="home-line"></span>
  </div>

  <div formArrayName="units" class="column gap-12">
    @for (unitCtrl of unitsArray.controls; track i; let i = $index) {
      <div class="row flex-center gap-8 width-100" [formGroupName]="i">
        <select
          class="label-lg"
          formControlName="unitId"
          [compareWith]="compareUnitById"
        >
          <option [ngValue]="null">-- اختر وحدة --</option>

          @for (unit of units; track unit.id) {
            <option [ngValue]="unit.id">{{ unit.name }}</option>
          }
        </select>

        <input
          class="label-lg"
          type="number"
          min="0"
          step="0.01"
          formControlName="price"
          placeholder="السعر"
        />

        <button
          type="button"
          class="btn danger"
          (click)="removeUnit(i)"
          [disabled]="unitsArray.length === 1"
        >
          حذف
        </button>
      </div>
    }
  </div>

  <button type="button" class="btn secondary" (click)="addUnit()">+ إضافة وحدة</button>

  <div class="flex-center gap-16">
    <button class="btn primary" type="submit" [disabled]="!canSubmit()">
      {{ mode === "edit" ? "تعديل" : "إضافة" }}
    </button>

    @if (canDelete()) {
      <button class="btn danger" type="button" (click)="onDelete()">حذف</button>
    }
  </div>
</form>
